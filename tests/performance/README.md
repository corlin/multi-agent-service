# ä¸“åˆ©ç³»ç»Ÿæ€§èƒ½æµ‹è¯•å¥—ä»¶

æœ¬ç›®å½•åŒ…å«ä¸“åˆ©åˆ†æç³»ç»Ÿçš„å®Œæ•´æ€§èƒ½æµ‹è¯•å¥—ä»¶ï¼Œç”¨äºè¯„ä¼°ç³»ç»Ÿåœ¨å„ç§è´Ÿè½½æ¡ä»¶ä¸‹çš„è¡¨ç°ã€‚

## ğŸ“ ç›®å½•ç»“æ„

```
tests/performance/
â”œâ”€â”€ README.md                           # æœ¬æ–‡æ¡£
â”œâ”€â”€ test_patent_performance.py          # åŸºç¡€æ€§èƒ½æµ‹è¯•
â”œâ”€â”€ test_patent_stress.py              # å‹åŠ›æµ‹è¯•
â”œâ”€â”€ benchmark_runner.py                 # åŸºå‡†æµ‹è¯•è¿è¡Œå™¨
â”œâ”€â”€ run_performance_tests.py            # ç»¼åˆæµ‹è¯•æ‰§è¡Œå™¨
â”œâ”€â”€ config/
â”‚   â””â”€â”€ benchmark_config.json          # åŸºå‡†æµ‹è¯•é…ç½®
â””â”€â”€ results/                           # æµ‹è¯•ç»“æœè¾“å‡ºç›®å½•
    â””â”€â”€ session_YYYYMMDD_HHMMSS/       # æŒ‰æ—¶é—´æˆ³ç»„ç»‡çš„æµ‹è¯•ä¼šè¯
        â”œâ”€â”€ benchmark_report_*.json     # JSONæ ¼å¼æŠ¥å‘Š
        â”œâ”€â”€ benchmark_report_*.html     # HTMLæ ¼å¼æŠ¥å‘Š
        â””â”€â”€ comprehensive_performance_report.*  # ç»¼åˆæŠ¥å‘Š
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ä½¿ç”¨uvè¿è¡Œå®Œæ•´æ€§èƒ½æµ‹è¯•å¥—ä»¶

```bash
# è¿è¡Œå®Œæ•´æ€§èƒ½æµ‹è¯•å¥—ä»¶
uv run python tests/performance/run_performance_tests.py

# å¿«é€Ÿæµ‹è¯•æ¨¡å¼ï¼ˆæ¨èç”¨äºå¼€å‘ç¯å¢ƒï¼‰
uv run python tests/performance/run_performance_tests.py --quick

# è¿è¡Œç‰¹å®šæµ‹è¯•
uv run python tests/performance/run_performance_tests.py --tests single_agent_baseline concurrent_analysis_light

# ä½¿ç”¨è‡ªå®šä¹‰é…ç½®
uv run python tests/performance/run_performance_tests.py --config tests/performance/config/benchmark_config.json
```

### ä½¿ç”¨ä¾¿æ·è„šæœ¬

```bash
# è¿è¡Œé»˜è®¤æ€§èƒ½æµ‹è¯•
uv run python scripts/run_patent_performance_tests.py

# è¿è¡Œç‰¹å®šæµ‹è¯•
uv run python scripts/run_patent_performance_tests.py specific

# ä½¿ç”¨pytestè¿è¡Œ
uv run python scripts/run_patent_performance_tests.py pytest
```

### ä½¿ç”¨pytestç›´æ¥è¿è¡Œ

```bash
# è¿è¡Œæ‰€æœ‰æ€§èƒ½æµ‹è¯•
uv run pytest tests/performance/ -v

# è¿è¡Œç‰¹å®šæµ‹è¯•æ–‡ä»¶
uv run pytest tests/performance/test_patent_performance.py -v

# è¿è¡Œå‹åŠ›æµ‹è¯•
uv run pytest tests/performance/test_patent_stress.py -v
```

## ğŸ“Š æµ‹è¯•ç±»å‹

### 1. åŸºç¡€æ€§èƒ½æµ‹è¯• (`test_patent_performance.py`)

- **å•Agentæ€§èƒ½åŸºçº¿æµ‹è¯•**: æµ‹è¯•å•ä¸ªAgentçš„å“åº”æ—¶é—´å’Œèµ„æºä½¿ç”¨
- **å¹¶å‘åˆ†æè¯·æ±‚æµ‹è¯•**: æµ‹è¯•ç³»ç»Ÿå¤„ç†å¹¶å‘è¯·æ±‚çš„èƒ½åŠ›
- **å¤§æ•°æ®é‡å¤„ç†æµ‹è¯•**: æµ‹è¯•ç³»ç»Ÿå¤„ç†å¤§é‡ä¸“åˆ©æ•°æ®çš„æ€§èƒ½
- **Agentè´Ÿè½½å‡è¡¡æµ‹è¯•**: æµ‹è¯•å¤šAgentå®ä¾‹çš„è´Ÿè½½åˆ†é…
- **èµ„æºç›‘æ§æµ‹è¯•**: ç›‘æ§å†…å­˜å’ŒCPUä½¿ç”¨æƒ…å†µ

### 2. å‹åŠ›æµ‹è¯• (`test_patent_stress.py`)

- **é«˜å¹¶å‘å‹åŠ›æµ‹è¯•**: æ¨¡æ‹Ÿå¤§é‡å¹¶å‘ç”¨æˆ·è®¿é—®
- **æŒç»­è´Ÿè½½æµ‹è¯•**: é•¿æ—¶é—´æŒç»­è´Ÿè½½ä¸‹çš„ç³»ç»Ÿè¡¨ç°
- **å†…å­˜æ³„æ¼æ£€æµ‹**: æ£€æµ‹é•¿æœŸè¿è¡Œä¸­çš„å†…å­˜æ³„æ¼é—®é¢˜
- **æ€§èƒ½å›å½’æ£€æµ‹**: å¯¹æ¯”åŸºå‡†æ€§èƒ½ï¼Œæ£€æµ‹æ€§èƒ½é€€åŒ–

### 3. åŸºå‡†æµ‹è¯• (`benchmark_runner.py`)

- **å¯é…ç½®çš„åŸºå‡†æµ‹è¯•**: æ”¯æŒè‡ªå®šä¹‰æµ‹è¯•å‚æ•°
- **å¤šç»´åº¦æ€§èƒ½æŒ‡æ ‡**: å“åº”æ—¶é—´ã€ååé‡ã€æˆåŠŸç‡ã€èµ„æºä½¿ç”¨
- **è‡ªåŠ¨åŒ–æŠ¥å‘Šç”Ÿæˆ**: JSONå’ŒHTMLæ ¼å¼çš„è¯¦ç»†æŠ¥å‘Š
- **æ€§èƒ½è¶‹åŠ¿åˆ†æ**: å†å²æ€§èƒ½æ•°æ®å¯¹æ¯”

## âš™ï¸ é…ç½®è¯´æ˜

### åŸºå‡†æµ‹è¯•é…ç½® (`config/benchmark_config.json`)

```json
{
  "test_name": "single_agent_baseline",
  "description": "å•ä¸ªä¸“åˆ©Agentæ€§èƒ½åŸºçº¿æµ‹è¯•",
  "enabled": true,
  "timeout": 120,
  "retry_count": 2,
  "warm_up_requests": 5,
  "benchmark_requests": 30,
  "concurrent_users": 1,
  "target_response_time": 3.0,
  "target_success_rate": 0.95,
  "target_throughput": 1.0
}
```

**é…ç½®å‚æ•°è¯´æ˜**:
- `test_name`: æµ‹è¯•åç§°
- `description`: æµ‹è¯•æè¿°
- `enabled`: æ˜¯å¦å¯ç”¨è¯¥æµ‹è¯•
- `timeout`: æµ‹è¯•è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
- `retry_count`: å¤±è´¥é‡è¯•æ¬¡æ•°
- `warm_up_requests`: é¢„çƒ­è¯·æ±‚æ•°é‡
- `benchmark_requests`: åŸºå‡†æµ‹è¯•è¯·æ±‚æ•°é‡
- `concurrent_users`: å¹¶å‘ç”¨æˆ·æ•°
- `target_response_time`: ç›®æ ‡å“åº”æ—¶é—´ï¼ˆç§’ï¼‰
- `target_success_rate`: ç›®æ ‡æˆåŠŸç‡ï¼ˆ0-1ï¼‰
- `target_throughput`: ç›®æ ‡ååé‡ï¼ˆRPSï¼‰

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

### æ ¸å¿ƒæŒ‡æ ‡

1. **å“åº”æ—¶é—´æŒ‡æ ‡**
   - å¹³å‡å“åº”æ—¶é—´
   - ä¸­ä½æ•°å“åº”æ—¶é—´
   - 95%åˆ†ä½æ•°å“åº”æ—¶é—´
   - 99%åˆ†ä½æ•°å“åº”æ—¶é—´
   - æœ€å¤§/æœ€å°å“åº”æ—¶é—´

2. **ååé‡æŒ‡æ ‡**
   - æ¯ç§’è¯·æ±‚æ•° (RPS)
   - æ¯ç§’æˆåŠŸè¯·æ±‚æ•°
   - æ€»å¤„ç†è¯·æ±‚æ•°

3. **å¯é æ€§æŒ‡æ ‡**
   - æˆåŠŸç‡
   - é”™è¯¯ç‡
   - è¶…æ—¶ç‡

4. **èµ„æºä½¿ç”¨æŒ‡æ ‡**
   - å†…å­˜ä½¿ç”¨é‡ï¼ˆå¹³å‡/å³°å€¼ï¼‰
   - CPUä½¿ç”¨ç‡
   - å†…å­˜å¢é•¿è¶‹åŠ¿

### æ€§èƒ½ç­‰çº§è¯„å®š

- **Açº§ (90-100åˆ†)**: ä¼˜ç§€ï¼Œæ‰€æœ‰æŒ‡æ ‡å‡è¾¾åˆ°æˆ–è¶…è¿‡ç›®æ ‡
- **Bçº§ (80-89åˆ†)**: è‰¯å¥½ï¼Œå¤§éƒ¨åˆ†æŒ‡æ ‡è¾¾æ ‡
- **Cçº§ (70-79åˆ†)**: ä¸€èˆ¬ï¼Œéƒ¨åˆ†æŒ‡æ ‡éœ€è¦ä¼˜åŒ–
- **Dçº§ (60-69åˆ†)**: è¾ƒå·®ï¼Œå¤šé¡¹æŒ‡æ ‡ä¸è¾¾æ ‡
- **Fçº§ (0-59åˆ†)**: å¤±è´¥ï¼Œç³»ç»Ÿæ€§èƒ½ä¸¥é‡ä¸è¶³

## ğŸ“‹ æµ‹è¯•æŠ¥å‘Š

### æŠ¥å‘Šç±»å‹

1. **JSONæŠ¥å‘Š**: æœºå™¨å¯è¯»çš„è¯¦ç»†æµ‹è¯•æ•°æ®
2. **HTMLæŠ¥å‘Š**: äººç±»å‹å¥½çš„å¯è§†åŒ–æŠ¥å‘Š
3. **ç»¼åˆæŠ¥å‘Š**: åŒ…å«æ‰€æœ‰æµ‹è¯•ç»“æœçš„æ±‡æ€»æŠ¥å‘Š

### æŠ¥å‘Šå†…å®¹

- **æµ‹è¯•æ¦‚è§ˆ**: æ€»ä½“æµ‹è¯•ç»“æœå’Œç»Ÿè®¡ä¿¡æ¯
- **æ€§èƒ½è¯„ä¼°**: åŸºäºé¢„è®¾ç›®æ ‡çš„æ€§èƒ½ç­‰çº§è¯„å®š
- **è¯¦ç»†æŒ‡æ ‡**: æ¯ä¸ªæµ‹è¯•çš„å…·ä½“æ€§èƒ½æ•°æ®
- **é—®é¢˜è¯†åˆ«**: è‡ªåŠ¨è¯†åˆ«çš„æ€§èƒ½é—®é¢˜å’Œè­¦å‘Š
- **ä¼˜åŒ–å»ºè®®**: åŸºäºæµ‹è¯•ç»“æœçš„æ€§èƒ½ä¼˜åŒ–å»ºè®®
- **ç³»ç»Ÿä¿¡æ¯**: æµ‹è¯•ç¯å¢ƒçš„ç¡¬ä»¶å’Œè½¯ä»¶ä¿¡æ¯

## ğŸ”§ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°çš„æ€§èƒ½æµ‹è¯•

1. **åˆ›å»ºæµ‹è¯•å‡½æ•°**:
```python
@pytest.mark.asyncio
async def test_new_performance_scenario(performance_monitor, mock_patent_agents):
    """æ–°çš„æ€§èƒ½æµ‹è¯•åœºæ™¯"""
    # æµ‹è¯•é€»è¾‘
    pass
```

2. **æ·»åŠ åŸºå‡†é…ç½®**:
```json
{
  "test_name": "new_performance_test",
  "description": "æ–°çš„æ€§èƒ½æµ‹è¯•æè¿°",
  "enabled": true,
  // ... å…¶ä»–é…ç½®
}
```

3. **æ›´æ–°æµ‹è¯•å¥—ä»¶**:
åœ¨ `run_performance_tests.py` ä¸­æ·»åŠ æ–°æµ‹è¯•çš„å¤„ç†é€»è¾‘ã€‚

### è‡ªå®šä¹‰æ€§èƒ½æŒ‡æ ‡

```python
class CustomPerformanceMetrics:
    def __init__(self):
        self.custom_metric = 0
    
    def collect_metric(self, value):
        self.custom_metric = value
    
    def get_metrics(self):
        return {'custom_metric': self.custom_metric}
```

### æ‰©å±•æŠ¥å‘Šæ ¼å¼

å¯ä»¥é€šè¿‡ä¿®æ”¹ `benchmark_runner.py` ä¸­çš„æŠ¥å‘Šç”Ÿæˆæ–¹æ³•æ¥æ·»åŠ æ–°çš„æŠ¥å‘Šæ ¼å¼æˆ–è‡ªå®šä¹‰æŠ¥å‘Šå†…å®¹ã€‚

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æµ‹è¯•è¶…æ—¶**
   - æ£€æŸ¥ç³»ç»Ÿèµ„æºæ˜¯å¦å……è¶³
   - è°ƒæ•´æµ‹è¯•é…ç½®ä¸­çš„è¶…æ—¶æ—¶é—´
   - å‡å°‘å¹¶å‘ç”¨æˆ·æ•°æˆ–è¯·æ±‚æ•°é‡

2. **å†…å­˜ä¸è¶³**
   - ç›‘æ§ç³»ç»Ÿå†…å­˜ä½¿ç”¨
   - è°ƒæ•´æµ‹è¯•å‚æ•°å‡å°‘å†…å­˜å‹åŠ›
   - æ£€æŸ¥æ˜¯å¦å­˜åœ¨å†…å­˜æ³„æ¼

3. **æµ‹è¯•å¤±è´¥ç‡é«˜**
   - æ£€æŸ¥æ¨¡æ‹ŸAgentçš„é…ç½®
   - éªŒè¯æµ‹è¯•ç¯å¢ƒçš„ç¨³å®šæ€§
   - è°ƒæ•´ç›®æ ‡æ€§èƒ½æŒ‡æ ‡

### è°ƒè¯•æŠ€å·§

1. **å¯ç”¨è¯¦ç»†æ—¥å¿—**:
```bash
uv run python tests/performance/run_performance_tests.py --verbose
```

2. **å•ç‹¬è¿è¡Œå¤±è´¥çš„æµ‹è¯•**:
```bash
uv run pytest tests/performance/test_patent_performance.py::test_specific_function -v -s
```

3. **æ£€æŸ¥æµ‹è¯•ç»“æœ**:
æŸ¥çœ‹ `tests/performance/results/` ç›®å½•ä¸‹çš„è¯¦ç»†æŠ¥å‘Šã€‚

## ğŸ“š æœ€ä½³å®è·µ

### æµ‹è¯•ç¯å¢ƒ

1. **éš”ç¦»æµ‹è¯•ç¯å¢ƒ**: åœ¨ä¸“ç”¨çš„æµ‹è¯•ç¯å¢ƒä¸­è¿è¡Œæ€§èƒ½æµ‹è¯•
2. **ç¨³å®šçš„ç¡¬ä»¶**: ä½¿ç”¨é…ç½®ä¸€è‡´çš„ç¡¬ä»¶ç¯å¢ƒ
3. **æœ€å°åŒ–å¹²æ‰°**: å…³é—­ä¸å¿…è¦çš„åå°è¿›ç¨‹

### æµ‹è¯•ç­–ç•¥

1. **æ¸è¿›å¼æµ‹è¯•**: ä»å°è´Ÿè½½å¼€å§‹ï¼Œé€æ­¥å¢åŠ å‹åŠ›
2. **é‡å¤æµ‹è¯•**: å¤šæ¬¡è¿è¡Œç¡®ä¿ç»“æœçš„ä¸€è‡´æ€§
3. **åŸºçº¿å»ºç«‹**: å»ºç«‹æ€§èƒ½åŸºçº¿ç”¨äºå›å½’æ£€æµ‹

### ç»“æœåˆ†æ

1. **è¶‹åŠ¿åˆ†æ**: å…³æ³¨æ€§èƒ½æŒ‡æ ‡çš„å˜åŒ–è¶‹åŠ¿
2. **ç“¶é¢ˆè¯†åˆ«**: è¯†åˆ«ç³»ç»Ÿçš„æ€§èƒ½ç“¶é¢ˆç‚¹
3. **ä¼˜åŒ–éªŒè¯**: éªŒè¯æ€§èƒ½ä¼˜åŒ–çš„æ•ˆæœ

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [ä¸“åˆ©ç³»ç»Ÿè®¾è®¡æ–‡æ¡£](../../.kiro/specs/patent-mvp-system/design.md)
- [ä¸“åˆ©ç³»ç»Ÿéœ€æ±‚æ–‡æ¡£](../../.kiro/specs/patent-mvp-system/requirements.md)
- [ä¸“åˆ©ç³»ç»Ÿä»»åŠ¡æ¸…å•](../../.kiro/specs/patent-mvp-system/tasks.md)

## ğŸ“ æ”¯æŒ

å¦‚æœåœ¨ä½¿ç”¨æ€§èƒ½æµ‹è¯•å¥—ä»¶æ—¶é‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š

1. æŸ¥çœ‹æœ¬æ–‡æ¡£çš„æ•…éšœæ’é™¤éƒ¨åˆ†
2. æ£€æŸ¥æµ‹è¯•ç»“æœä¸­çš„é”™è¯¯ä¿¡æ¯
3. æŸ¥çœ‹ç”Ÿæˆçš„HTMLæŠ¥å‘Šä¸­çš„è¯¦ç»†åˆ†æ
4. æäº¤Issueå¹¶é™„ä¸Šç›¸å…³çš„æµ‹è¯•æŠ¥å‘Š